(this["webpackJsonpv8-cadreboisart-reste-pp-et-taille-cadre"]=this["webpackJsonpv8-cadreboisart-reste-pp-et-taille-cadre"]||[]).push([[0],{20:function(e,t,a){},26:function(e,t){},27:function(e,t){},28:function(e,t){},32:function(e,t,a){"use strict";a.r(t);var s=a(2),o=a(12),n=a.n(o),c=(a(20),a(3)),i=a(33),r=a(8),l=a(4),d=a(34),b=a(0),j=a(1);d.a.preload("/MugModel.gltf");var u=function(e){const t=Object(s.useRef)(),{nodes:a,materials:o}=Object(d.a)("/MugModel.gltf"),{gl:n}=Object(c.d)();let i,r,l=Array.from(document.getElementsByTagName("canvas"))[1];return i=l.getContext("2d"),r=new b.CanvasTexture(i.canvas),r.flipY=!1,r.anisotropy=n.capabilities.getMaxAnisotropy(),r.needsUpdate=!0,console.log(e.animationSpeed),Object(c.b)(((a,s)=>{e.animation&&(e.reverse?t.current.rotation.y-=.001*e.animationSpeed:t.current.rotation.y+=.001*e.animationSpeed),r.needsUpdate=!0})),Object(j.jsxs)("group",{scale:10,rotation:[0,1.812,0],position:[0,-.5,0],ref:t,...e,dispose:null,children:["//ANSE //",Object(j.jsxs)("group",{rotation:[0,-.412,0],children:[Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.Exterior.geometry,material:o["white-material"]}),Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.Cylinder003_1.geometry,material:o["color-material"]})]}),"// EXTERIEUR",Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.Exterior.geometry,material:o["white-material"],rotation:[0,-.412,0]}),"// ZONE D'IMPRESSION DU MODEL",Object(j.jsx)("mesh",{rotation:[0,-.412,0],castShadow:!0,receiveShadow:!0,geometry:a.Impression.geometry,material:o["map-material"],flipY:!0,children:Object(j.jsx)("meshStandardMaterial",{attach:"material",map:r,children:Object(j.jsx)("canvasTexture",{attach:"map",image:l})})}),"// INTERIEUR",Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.Interior.geometry,material:o["color-material"],rotation:[0,-.412,0]})]})};d.a.preload("/baguette.gltf");var h=function(e){const{nodes:t,materials:a}=Object(d.a)("/baguette.gltf");return Object(j.jsxs)("group",{...e,dispose:null,children:[Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Cube001.geometry,material:a.Material,position:[-.008,-15,0],rotation:[Math.PI,0,Math.PI]}),Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Cube002.geometry,material:a.Material,position:[-.008,15,0],rotation:[Math.PI,0,0]}),Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Cube003.geometry,material:a.Material,position:[-11,0,0],rotation:[Math.PI,0,-1.571]}),Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Cube005.geometry,material:a.Material,position:[11,0,0],rotation:[Math.PI,0,1.571]})]})},g=a(7);d.a.preload("/BaguetteSimple.gltf");d.a.preload("/baguetteTextureMelange.gltf");var O=e=>{let{label:t,initialValue:a,onLengthChange:o,maxValue:n,minValue:c}=e;const[i,r]=Object(s.useState)(a);return Object(s.useEffect)((()=>{o(a)}),[]),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{htmlFor:"baguette".concat(t,"Input"),children:" ".concat(t,":")}),Object(j.jsx)("input",{type:"number",id:"baguette".concat(t,"Input"),value:i,onChange:e=>{const t=parseFloat(e.target.value);r(t),o(t)},min:c,max:n,step:"0.5"}),Object(j.jsx)("span",{children:" cm"})]})};function m(e){const{nodes:t,materials:a}=Object(d.a)("/BaguetteBois3.gltf"),o=t.Baguette.geometry.clone(),n=o.boundingBox.size(),c=(new g.a).load("/wood_texture.jpg");new b.MeshStandardMaterial({map:c});return Object(s.useEffect)((()=>{const t=o.attributes.position.array;for(let a=0;a<t.length/2;a+=3)t[a]=t[a]+(e.LongueurBaguette-n.x)/2;for(let a=t.length/2;a<t.length;a+=3)t[a]=t[a]-(e.LongueurBaguette-n.x)/2;o.attributes.position.needsUpdate=!0}),[e.LongueurBaguette,o.attributes.position]),Object(s.useEffect)((()=>{const t=o.attributes.position.array;console.log(o.attributes);const a=[23,24,25,26,36,37,38,30,31,32],s=b.MathUtils.degToRad(45),n=e.BaguetteWidth-2;for(const e of a){const a=3*e,o=t[a],c=(t[a+1],t[a+2]),i=o-Math.cos(s)*n,r=c-Math.sin(s)*n;t[a]=i,t[a+2]=r,console.log(e,i,r)}const c=[0,1,2,13,14,15,16,6,7,8];for(const e of c){const a=3*e,o=t[a],c=(t[a+1],t[a+2]-Math.sin(s)*n),i=o+Math.cos(s)*n;t[a]=i,t[a+2]=c}o.attributes.position.needsUpdate=!0}),[e.BaguetteHWidth,o.attributes.position]),Object(s.useEffect)((()=>{const t=o.attributes.position.array,a=[3,4,5,6,7,8,27,28,29,30,31,32],s=e.BaguetteHeight-2;for(const e of a){const a=3*e;t[a+1]=t[a+1]+s}o.attributes.position.needsUpdate=!0}),[e.BaguetteHeight,o.attributes.position]),Object(s.useEffect)((()=>{const t=o.attributes.position.array,a=[9,10,11,12,20,21,22],s=b.MathUtils.degToRad(45),n=e.RabateWidth-1;for(const e of a){const a=3*e,o=t[a],c=(t[a+1],t[a+2]),i=o+Math.cos(s)*n,r=c-Math.sin(s)*n;t[a]=i,t[a+2]=r}const c=[33,34,35,42,43,44,45];for(const e of c){const a=3*e,o=t[a],c=(t[a+1],t[a+2]),i=o-Math.cos(s)*n,r=c-Math.sin(s)*n;t[a]=i,t[a+2]=r}o.attributes.position.needsUpdate=!0}),[e.RabateWidth,o.attributes.position]),Object(s.useEffect)((()=>{const t=o.attributes.position.array,a=[13,14,15,16,17,18,19,20,21,22,36,37,38,42,43,44,45,39,40,41],s=e.RabateHeight-1.5;for(const e of a){const a=3*e;t[a+1]=t[a+1]+s}o.attributes.position.needsUpdate=!0}),[e.RabateHeight,o.attributes.position]),Object(j.jsx)("group",{...e,dispose:null,children:Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:o,children:Object(j.jsx)("meshStandardMaterial",{map:c})})})}function p(e){const{nodes:t,materials:a}=Object(d.a)("/ModelPP.gltf");console.log(e.PPColor);const s=new b.Color(e.PPColor);return a["Handmade Paper 01"].color=s,Object(j.jsx)("group",{...e,dispose:null,children:Object(j.jsxs)("group",{scale:[1,.5,1],position:[0,-2,0],children:[Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Cube_1.geometry,material:a["Handmade Paper 01"]}),Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Cube_2.geometry,material:a.Ame})]})})}function x(e){const{nodes:t,materials:a}=Object(d.a)("/ModelDos.gltf"),s=new b.Color(e.colorPP);return a["Paper old"].color=s,Object(j.jsx)("group",{...e,dispose:null,children:Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Dos.geometry,material:a["Paper old"],position:[0,-2.1,0]})})}d.a.preload("/baguetteBois3.gltf"),d.a.preload("/ModelDos.gltf"),d.a.preload("/ModelArt2.gltf");var v=function(e){const t=Object(s.useRef)(),{nodes:a,materials:o}=Object(d.a)("/ModelArt2.gltf"),{gl:n}=Object(c.d)(),i=new b.Vector3;a.IMPRESSION.geometry.boundingBox.getSize(i);const{nodes:r,materials:l}=Object(d.a)("/ModelArt3.gltf"),u=r.IMPRESSION.children[0].geometry,h=l["Map-Material"];let g,O,m=Array.from(document.getElementsByTagName("canvas"))[1];return g=m.getContext("2d"),O=new b.CanvasTexture(g.canvas),O.flipY=!1,O.anisotropy=n.capabilities.getMaxAnisotropy(),O.needsUpdate=!0,Object(c.b)(((a,s)=>{e.animation&&(t.current.rotation.z+=.03),O.needsUpdate=!0})),Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("group",{...e,position:[0,-2.1,0],rotation:[0,Math.PI/2,0],dispose:null,children:Object(j.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:u,material:h,scale:.02,children:Object(j.jsx)("meshStandardMaterial",{attach:"material",map:O,children:Object(j.jsx)("canvasTexture",{attach:"map",image:m})})})})})};var f=e=>{let{position:t,visibleArt:a,visibleDos:s,visiblePP:o,frameColor:n,DosColor:c,PPColor:i,CadreExtWidth:r,CadreExtHeight:l,BaguetteWidth:d,BaguetteHeight:b,RabateHeight:u,RabateWidth:h,BaguetteSeule:g}=e;return Object(j.jsxs)("group",{children:[o?Object(j.jsx)(p,{PPColor:i}):null,s?Object(j.jsx)(x,{DosColor:c}):null,a?Object(j.jsx)(v,{}):null,g?Object(j.jsx)(m,{position:[0,t[1],-l/2+1],frameColor:n,RabateHeight:u,RabateWidth:h,BaguetteWidth:d,BaguetteHeight:b,LongueurBaguette:r}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("group",{children:[Object(j.jsx)(m,{position:[0,t[1],-l/2+1.5],frameColor:n,RabateHeight:u,RabateWidth:h,BaguetteWidth:d,BaguetteHeight:b,LongueurBaguette:r}),Object(j.jsx)(m,{position:[r/2-1.5,t[1],0],rotation:[0,3*Math.PI/2,0],frameColor:n,RabateHeight:u,RabateWidth:h,BaguetteWidth:d,BaguetteHeight:b,LongueurBaguette:l})]}),Object(j.jsxs)("group",{rotation:[0,Math.PI,0],children:[Object(j.jsx)(m,{position:[0,t[1],-l/2+1.5],frameColor:n,RabateHeight:u,RabateWidth:h,BaguetteWidth:d,BaguetteHeight:b,LongueurBaguette:r}),Object(j.jsx)(m,{position:[r/2-1.5,t[1],0],rotation:[0,3*Math.PI/2,0],frameColor:n,RabateHeight:u,RabateWidth:h,BaguetteWidth:d,BaguetteHeight:b,LongueurBaguette:l})]})]})]})};function S(){const{editor:e,onReady:t}=Object(r.b)(),[a,o]=Object(s.useState)("#FF0000"),[n,d]=Object(s.useState)("#000000"),[b,g]=Object(s.useState)("#FFFFFF"),[m,p]=Object(s.useState)(2),[x,v]=Object(s.useState)(!1),[S,C]=Object(s.useState)(!1),[y,w]=Object(s.useState)(!1),[M,R]=Object(s.useState)(!0),[k,B]=Object(s.useState)(!1),[E,A]=Object(s.useState)(""),[P,L]=Object(s.useState)(10),[V,D]=Object(s.useState)(0),[H,I]=Object(s.useState)(22.3),[U,W]=Object(s.useState)(22.3),[F,N]=Object(s.useState)(1),[T,G]=Object(s.useState)(1.5),[_,Y]=Object(s.useState)(2),[q,z]=Object(s.useState)(2),[J,X]=Object(s.useState)(!1),[Z,K]=Object(s.useState)("#EECC00"),[Q,$]=Object(s.useState)("#D2B37F"),[ee,te]=Object(s.useState)("#222222"),[ae,se]=Object(s.useState)(!0),[oe,ne]=Object(s.useState)(!0),[ce,ie]=Object(s.useState)(!0),[re,le]=Object(s.useState)(10),[de,be]=Object(s.useState)(10),je=[];const ue=Object(s.useRef)();Object(s.useEffect)((()=>{if(e){e.canvas.backgroundColor=b,e.canvas.setDimensions({width:500,height:500*de/re}),e.setFillColor(a),e.setStrokeColor(n);const t=JSON.stringify(e.canvas,null,2);ue.current=t,A(t)}})),Object(s.useEffect)((()=>{e&&l.fabric&&(e.canvas.getActiveObject.strokeWidth=parseInt(m),e.setStrokeColor(n),e.setFillColor(a),e.canvas.backgroundColor=b)}),[n,a,m,P,b]),Object(s.useEffect)((()=>{e&&l.fabric&&(e.canvas.freeDrawingBrush.color=n,e.setStrokeColor(n))}),[n]);const he=()=>{e.canvas.discardActiveObject();var t=new l.fabric.ActiveSelection(e.canvas.getObjects(),{canvas:e.canvas});e.canvas.setActiveObject(t),e.canvas.requestRenderAll()};return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)("div",{className:"espace",children:Object(j.jsxs)(c.a,{frameloop:"always",shadows:!0,dpr:[1,2],camera:{position:[0,30,-5],fov:85},children:[Object(j.jsx)("color",{attach:"background",args:["#EFCDAB"]}),Object(j.jsx)("ambientLight",{intensity:.2}),Object(j.jsx)("directionalLight",{intensity:.4}),Object(j.jsxs)(s.Suspense,{fallback:null,children:[S?Object(j.jsx)(CadreModel,{animation:M,reverse:k,animationSpeed:P}):null,y?Object(j.jsx)(h,{animation:M,reverse:k,animationSpeed:P}):null,x?Object(j.jsx)(u,{animation:M,reverse:k,animationSpeed:P}):null,Object(j.jsx)(f,{position:[0,-2.5,0],frameColor:Z,CadreExtWidth:H,CadreExtHeight:U,BaguetteWidth:_,BaguetteHeight:q,RabateHeight:T,RabateWidth:F,BaguetteSeule:J,visiblePP:ae,visibleDos:oe,visibleArt:ce,PPColor:ee,DosColor:Q})]}),Object(j.jsx)(i.a,{})]})}),Object(j.jsxs)("div",{className:"test",children:[Object(j.jsxs)("div",{className:"cadre",children:[Object(j.jsxs)("div",{className:"cadre",children:[Object(j.jsx)(O,{label:"Largeur Cadre (cm)",initialValue:re,maxValue:"200",minValue:"5",onLengthChange:e=>{le(e)}}),Object(j.jsx)(O,{label:"Hauteur Cadre(cm)",initialValue:de,maxValue:"200",minValue:"5",onLengthChange:e=>{be(e)}})]}),Object(j.jsxs)("label",{disabled:!1,children:["Cadre",Object(j.jsx)("input",{disabled:!1,type:"color",value:Z,onChange:e=>K(e.target.value)})]}),Object(j.jsxs)("label",{disabled:!1,children:["PassePartout",Object(j.jsx)("input",{disabled:!1,type:"color",value:ee,onChange:e=>te(e.target.value)})]}),Object(j.jsx)("button",{onClick:()=>{se(!ae)},children:"Passe-partout"}),Object(j.jsxs)("div",{className:"cadre",children:[Object(j.jsx)(O,{label:"Largeur Cadre (cm)",initialValue:H,maxValue:"200",minValue:2*_,onLengthChange:e=>{I(e)}}),Object(j.jsx)(O,{label:"Hauteur Cadre(cm)",initialValue:U,maxValue:"200",minValue:2*_,onLengthChange:e=>{W(e)}}),Object(j.jsx)(O,{label:"Largeur Baguette(cm)",initialValue:_,maxValue:"10",minValue:"1",onLengthChange:e=>{Y(e)}}),Object(j.jsx)(O,{label:"Epaisseur Baguette",initialValue:q,maxValue:"10",minValue:"1",onLengthChange:e=>{z(e)}}),Object(j.jsx)(O,{label:"Hauteur Feuillure",initialValue:T,maxValue:q,minValue:"0.1",onLengthChange:e=>{G(e)}}),Object(j.jsx)(O,{label:"Largeur Feuillure",initialValue:F,maxValue:_,minValue:"0.1",onLengthChange:e=>{N(e)}})]}),Object(j.jsx)("div",{className:"boutons-cadre",children:Object(j.jsx)("button",{onClick:()=>{X(!J)},children:" Baguette seule"})})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:()=>{e.canvas.isDrawingMode=!1,e.addCircle()},children:"Circle"}),Object(j.jsx)("button",{onClick:()=>{e.canvas.isDrawingMode=!1;var t=new l.fabric.Ellipse({left:10,top:10,rx:30,ry:20,strokeWidth:parseInt(m),fill:a,stroke:n,strokeUniform:!0});e.canvas.add(t)},children:"Ellipse"}),Object(j.jsx)("button",{onClick:()=>{e.canvas.isDrawingMode=!1;var t=new l.fabric.Rect({left:10,top:10,width:100,height:50,strokeWidth:parseInt(m),fill:a,stroke:n,strokeUniform:!0});e.canvas.add(t)},children:"Rectangle"}),Object(j.jsx)("button",{onClick:()=>{e.canvas.isDrawingMode=!1,e.addText("Votre texte...")},children:"Texte"}),Object(j.jsx)("button",{onClick:()=>{e.canvas.isDrawingMode=!e.canvas.isDrawingMode},children:"Draw"})]}),Object(j.jsx)("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:t=>{e.canvas.isDrawingMode=!1;const a=t.target.files[0];if(a){const t=new FileReader;t.onload=t=>{const a=t.target.result;l.fabric.Image.fromURL(a,(t=>{console.log(t.width,t.height),t.width>t.height?t.scaleToHeight(e.canvas.height):t.scaleToWidth(e.canvas.width),t,e.canvas.add(t)}))},t.readAsDataURL(a)}}}),Object(j.jsx)("input",{type:"file",accept:".svg",onChange:t=>{const a=t.target.files[0];if(a){const t=new FileReader;t.onload=t=>{const a=t.target.result;l.fabric.loadSVGFromString(a,((t,a)=>{const s=new l.fabric.Group(t,a);e.canvas.add(s)}))},t.readAsText(a)}}}),Object(j.jsx)("button",{onClick:function(){const t=e.canvas.getActiveObject().height/2,a=new l.fabric.Circle({radius:t,originY:"center",originX:"center"});e.canvas.getActiveObject().clipPath=a,e.canvas.renderAll()},children:"Crop"}),Object(j.jsx)("div",{className:"canvas-container",children:Object(j.jsx)(r.a,{id:"cnvs",className:"sample-canvas",onReady:t,onSelect:e=>setSelectedObject(e.target)})}),Object(j.jsxs)("label",{disabled:!1,children:["Fill",Object(j.jsx)("input",{disabled:!1,type:"color",value:a,onChange:e=>o(e.target.value)})]}),Object(j.jsxs)("label",{disabled:!1,children:["Stroke",Object(j.jsx)("input",{disabled:!1,type:"color",value:n,onChange:e=>d(e.target.value)})]}),Object(j.jsxs)("label",{disabled:!1,children:["Back",Object(j.jsx)("input",{disabled:!1,type:"color",value:b,onChange:e=>g(e.target.value)})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:()=>{e.canvas.remove(e.canvas.getActiveObject())},children:"DELETE"}),Object(j.jsx)("button",{onClick:()=>{e.canvas._objects.splice(0,e.canvas._objects.length),je.splice(0,je.length),he(),e.canvas.renderAll()},children:"CLEAR"}),Object(j.jsx)("button",{onClick:he,children:"SELECT ALL"}),Object(j.jsx)("button",{onClick:()=>{e.canvas._objects.length>0&&je.push(e.canvas._objects.pop()),e.canvas.renderAll()},children:"UNDO"}),Object(j.jsx)("button",{onClick:()=>{je.length>0&&e.canvas.add(je.pop())},children:"REDO"})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:()=>{e.canvas.getActiveObject()&&"activeSelection"===e.canvas.getActiveObject().type&&(e.canvas.getActiveObject().toGroup(),e.canvas.requestRenderAll())},children:"Grouper"}),Object(j.jsx)("button",{onClick:()=>{e.canvas.getActiveObject()&&"group"===e.canvas.getActiveObject().type&&(e.canvas.getActiveObject().toActiveSelection(),e.canvas.requestRenderAll())},children:"D\xe9grouper"})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("input",{type:"range",id:"stroke",name:"stroke",value:m,min:"0",max:"30",onChange:e=>p(e.target.value)}),Object(j.jsxs)("label",{for:"volume",children:["Stroke Width: ",m," px"]})]}),Object(j.jsx)("div",{className:"fabric-canvas"}),Object(j.jsx)("p",{children:"move circle around"}),Object(j.jsx)("button",{onClick:()=>{v(!x)},children:"MUG"}),Object(j.jsx)("button",{onClick:()=>{C(!S)},children:"CADRE"}),Object(j.jsx)("div",{children:Object(j.jsxs)("label",{disabled:!1,children:[Object(j.jsx)("input",{disabled:!1,type:"checkbox",checked:M,value:M,onChange:()=>R(!M)}),"Start/ Stop Animation",Object(j.jsx)("input",{disabled:!1,type:"checkbox",checked:k,value:k,onChange:()=>B(!k)}),"Reverse",Object(j.jsx)("input",{type:"range",id:"speed",name:"speed",value:P,min:"1",max:"100",step:"1",onChange:e=>L(e.target.valueAsNumber)}),"Animation speed",Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:async()=>{const t=e.canvas.toDataURL({width:e.canvas.width,height:e.canvas.height,left:0,top:0,format:"png"}),a=document.createElement("a");a.download="image.png",a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)},children:"Save->PNG"}),Object(j.jsx)("button",{onClick:()=>{const t=e.canvas.toSVG(),a=new Blob([t],{type:"image/svg+xml"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download="canvas-export.svg",s.click(),URL.revokeObjectURL(s.href)},children:"Save->SVG"})]}),Object(j.jsxs)("div",{ref:ue,style:{whiteSpace:"pre-wrap"},children:[" ",E," "]})]})})]})]})})}n.a.render(Object(j.jsx)(S,{}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.747b5671.chunk.js.map